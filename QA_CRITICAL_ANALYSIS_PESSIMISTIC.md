# 🔴 Loop 프로젝트 - 비관적 관점 QA 분석 리스트

> **목적**: 잠재적 버그, 모호한 설계, 보안 허점, 성능 문제, 기술 부채를 **비판적으로** 식별하고 문서화

**작성일**: 2025-10-20  
**분석 범위**: src/ 전체 + root 설정 파일  
**심각도**: 🔴 Critical / 🟠 High / 🟡 Medium / 🟢 Low

---

## 📁 1. src/main/ - Main Process (Critical Zone)

### 📁 1.1 core/ - Bootstrap & Lifecycle

#### ⚠️ ApplicationBootstrapper.ts (463줄)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 1.1.1 | **3단계 부트스트랩 타이밍 경합(Race Condition)** | 🔴 | Phase 1(0ms)이 완료되지 않은 상태에서 Renderer가 IPC 호출할 수 있음. `EnvironmentService.initialize()` 호출이 constructor에서 "조기 초기화"되었으나, 실제 완료 시점 보장 없음. 만약 Phase 1 매니저 중 하나가 크래시하면? |
| 1.1.2 | **setTimeout 기반 타이밍의 신뢰성 부족** | 🟠 | `setTimeout(2000)`, `setTimeout(4000)`은 Node.js 이벤트 루프 상태에 따라 정확하지 않을 수 있음. 시스템이 바쁜 경우 2초가 10초 이상 소요될 수 있음. → Phase 2 매니저들이 실제로 활성화되지 않았는데 Renderer가 menu 명령 호출 |
| 1.1.3 | **에러 전파 불명확** | 🟡 | Phase 1 중 매니저 초기화 실패 시 어떻게 되나? `await this.initializeManagers()` 내부에서 try-catch가 있는가? 로그만 남고 앱이 좀비 상태로 실행될 가능성 |
| 1.1.4 | **환경변수 조기 초기화의 부작용** | 🟠 | `initializeEnvironmentServiceEarly()`가 constructor에서 실행되는데, 만약 .env 파일이 손상되어 있다면? 예외 처리가 있는지 불명확 |
| 1.1.5 | **Single Instance Lock 미구현 확인 필요** | 🟡 | Windows/Linux에서 `app.requestSingleInstanceLock()` 호출이 있는가? 사용자가 앱을 여러 번 클릭하면 여러 인스턴스가 실행될 수 있음 |
| 1.1.6 | **Protocol Handler 충돌 가능성** | 🟡 | `protocol.registerFileProtocol('loop')` 등록 시, 다른 앱이 같은 protocol을 등록했다면? 우아한 실패 처리가 있는가? |
| 1.1.7 | **Window 생성 전 IPC 핸들러 등록 미확인** | 🔴 | Renderer가 Window 로드 중에 IPC 호출을 시도하는데, 핸들러 등록 순서가 명확한가? `registerIpcHandlers()` 호출 시점이 Window 생성 전인지 후인지? |
| 1.1.8 | **Preload 스크립트 경로 보안** | 🟡 | `preload: path.join(__dirname, '../preload/index.js')` - 하드코딩된 상대 경로. 빌드 후 경로가 변할 가능성? `APP_IDENTITY` 상수로 관리하는 것이 나은가? |

#### ⚠️ ManagerCoordinator.ts (400줄)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 1.2.1 | **매니저 초기화 순서 문서화 부족** | 🟡 | 16개 매니저 중 어느 것이 먼저 초기화되어야 하는가? 예를 들어, `DatabaseManager`는 `MemoryManager` 전에 초기화되어야 하는가? 종속성 그래프가 없음 |
| 1.2.2 | **부분 초기화 상태 처리 불명확** | 🟡 | Phase 2 초기화 중 매니저 3개가 성공, 2개가 실패했다면? 앱이 일관성 있는 상태에 있는가? Rollback 로직이 있는가? |
| 1.2.3 | **재시작 로직의 안전성** | 🟠 | `restartManager(name)` 메서드 - 실행 중인 매니저를 재시작하면 중간에 요청이 들어올 수 있음. Mutex/Lock이 없음 |
| 1.2.4 | **매니저 상태 조회의 일관성** | 🟡 | `getManagerStatus()` 호출 후 바로 다음 코드 라인에서 매니저 상태가 변할 수 있음. Race condition의 위험 |
| 1.2.5 | **메모리 누수: 매니저 캐시 미제거** | 🟡 | 싱글톤 매니저들이 메모리에 영구 정착. 앱 재시작 시에도 이전 상태가 남아있는가? |

#### ⚠️ SettingsWatcher.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 1.3.1 | **설정 변경 감지 구현 미확인** | 🟡 | fs.watch() vs fs.watchFile() 중 어느 것 사용? fs.watch()는 플랫폼별로 동작이 다름. 특히 네트워크 드라이브에서는 동작 안 할 수 있음 |
| 1.3.2 | **설정 변경 알림 지연** | 🟡 | 사용자가 설정을 변경 → watcher가 감지 → UI 업데이트까지 몇 ms 지연? 동기화 불일치 가능성 |
| 1.3.3 | **중복 알림 처리 미확인** | 🟡 | 파일 시스템이 하나의 변경을 여러 번 감지할 수 있음. 중복 제거 로직(debounce)이 있는가? |

#### ⚠️ ShutdownManager.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 1.4.1 | **종료 타임아웃 미구현** | 🟡 | `shutdown()` 메서드가 무한 대기할 가능성. 매니저 정리가 오래 걸리면? Task manager에서 강제 종료해야 함 |
| 1.4.2 | **부분 종료 후 복구 불가** | 🔴 | 50%만 정리된 상태에서 크래시 → 다음 실행 시 잠금 파일, 임시 파일 남아있음 |
| 1.4.3 | **종료 순서 역순 보장 불명확** | 🟡 | 초기화 순서: A → B → C라면, 종료 순서는 C → B → A여야 하는가? 명시되지 않음 |

---

### 📁 1.2 handlers/ - IPC 핸들러 (32개)

#### ⚠️ projectIpcHandlers.ts (1251줄 - 가장 큼!)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 2.1.1 | **N+1 쿼리 문제** | 🔴 | `projects:get-all` 응답 시 각 프로젝트마다 캐릭터, 메모 등을 조회하는가? 프로젝트 1000개면 1001개 쿼리 실행 |
| 2.1.2 | **입력 검증 수준 미확인** | 🟡 | 모든 IPC 핸들러에 Zod 검증이 있는가? 동적으로 전달받은 `id`가 실제 cuid인지 확인? SQL Injection 위험(Prisma 사용하므로 낮지만) |
| 2.1.3 | **캐스케이드 삭제의 무한 루프** | 🟡 | 프로젝트 삭제 시 관련 모든 데이터(episode, character, note 등)도 삭제됨. 순환 참조가 있다면? |
| 2.1.4 | **트랜잭션 미사용** | 🟠 | 프로젝트 + 캐릭터 + 메모를 동시에 생성하는 중 실패하면 부분 생성된 데이터 남음 |
| 2.1.5 | **레이스 컨디션: 동시 업데이트** | 🟠 | 사용자 A와 B가 동시에 같은 프로젝트를 수정 → 마지막 쓰기가 우선 (Last Write Wins, 데이터 손실 가능) |
| 2.1.6 | **메모리 부족 시 대용량 데이터 로드** | 🟡 | 프로젝트에 100,000줄의 콘텐츠가 있다면? 전체를 메모리로 로드할 때 OOM 가능성 |
| 2.1.7 | **Prisma 클라이언트 재사용 미확인** | 🟡 | 각 IPC 핸들러에서 `prisma.project.findUnique()` 호출 시 같은 클라이언트 인스턴스를 사용하는가? 여러 인스턴스면 연결 풀 낭비 |
| 2.1.8 | **응답 크기 제한 없음** | 🟡 | 대용량 프로젝트 조회 응답이 몇 MB가 되면? IPC 채널이 아래아래아래 막힐 수 있음 |
| 2.1.9 | **삭제 복구 불가** | 🟡 | SOFT DELETE 미사용. 사용자가 실수로 프로젝트 삭제 → 영구 손실 |
| 2.1.10 | **감시(audit) 로그 부재** | 🟡 | 누가, 언제, 어떤 프로젝트를 수정했는가? 감시 추적 없음 |

#### ⚠️ aiIpcHandlers.ts (419줄)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 2.2.1 | **API 요청 타임아웃 미처리** | 🔴 | OpenAI/Gemini API 호출이 30초 이상 소요되면? Renderer가 무한 대기? UI 응답 불가 |
| 2.2.2 | **API 키 노출 위험** | 🔴 | `OPENAI_API_KEY`, `GEMINI_API_KEY`가 IPC 응답에 포함되는가? Renderer 메모리 덤프 시 노출 가능 |
| 2.2.3 | **스트리밍 응답 버퍼 오버플로우** | 🟡 | AI 응답이 매우 크면(500KB+)? IPC 채널 버퍼 부족 가능성 |
| 2.2.4 | **동시 AI 요청 제한 없음** | 🟡 | 사용자가 "분석" 버튼을 10번 빠르게 클릭 → 10개 API 요청 동시 발송 → 비용 폭증 + API 할당량 초과 |
| 2.2.5 | **실패 응답의 프롬프트 노출** | 🟡 | AI 에러 메시지에 사용자 프롬프트가 포함되는가? 민감한 내용 노출 위험 |
| 2.2.6 | **토큰 사용량 추적 미확인** | 🟡 | API 호출마다 토큰 사용? 누적량 추적? 월 한계 체크? |

#### ⚠️ settingsIpcHandlers.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 2.3.1 | **설정 검증 수준 미확인** | 🟡 | 사용자가 `{ autoSaveInterval: -1 }` 전달 → 검증 실패? |
| 2.3.2 | **설정 마이그레이션 미지원** | 🟡 | 앱 업그레이드 시 새로운 설정 키 추가 → 레거시 사용자는 기본값? 일관성 보장? |
| 2.3.3 | **electron-store 암호화 미확인** | 🟠 | 사용자 토큰, API 키가 plain text로 저장되는가? |

#### ⚠️ databaseIpcHandlers.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 2.4.1 | **백업 중 쓰기 미차단** | 🟡 | 백업 중에 Renderer가 프로젝트 저장 → 불완전한 백업 파일 |
| 2.4.2 | **복원 시 기존 데이터 보존 안 함** | 🟠 | 복원 실패 시 이전 상태로 롤백 불가 |
| 2.4.3 | **DB 무결성 검사 미포함** | 🟡 | 복원 후 데이터 일관성 검증? 외래키 무결성? |

#### ⚠️ geminiIpcHandlers.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 2.5.1 | **Gemini API 스트리밍 상태 추적 미확인** | 🟡 | 스트리밍 중 Renderer가 요청 취소 → 메모리 누수 가능성 |
| 2.5.2 | **컨텍스트 윈도우 크기 제한 미확인** | 🟡 | Gemini 프롬프트가 100K 토큰 넘으면? 에러 처리? |

---

### 📁 1.3 managers/ - 16개 매니저

#### ⚠️ MemoryManager.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 3.1.1 | **메모리 임계값 기준 불명확** | 🟡 | 80% 경고, 90% 위험, 95% 긴급 → 근거는? 시스템 RAM이 4GB라면? 32GB라면? |
| 3.1.2 | **메모리 누수 감지 미구현** | 🟡 | 지속적인 메모리 증가 패턴 감지? 아니면 절대값만 모니터링? |
| 3.1.3 | **GC 강제 트리거 부작용** | 🟡 | `global.gc()` 호출 시 앱 응답 정지(Stop the world). UI 끊김 가능성 |
| 3.1.4 | **메모리 풀 구현 미확인** | 🟡 | "4개 메모리 풀"이 실제로 구현되었는가? 아니면 계획 단계? |

#### ⚠️ DatabaseManager.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 3.2.1 | **Prisma 마이그레이션 자동 실행** | 🟡 | 앱 시작 시 자동 마이그레이션? 만약 마이그레이션 실패하면? 앱이 구동 불가 |
| 3.2.2 | **DB 연결 풀 고갈** | 🟡 | 기본 풀 크기는? Long-running query가 있으면? 다른 IPC 요청 대기? |
| 3.2.3 | **SQLite 잠금 대기** | 🟠 | SQLite는 동시 쓰기 1개만 허용. IPC 핸들러 10개가 동시에 쓰기 시도 → SQLITE_BUSY 에러 |

#### ⚠️ WindowManager.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 3.3.1 | **Window 크기/위치 복원 오류** | 🟡 | 저장된 좌표가 현재 모니터 범위 밖이면? 창이 보이지 않음 |
| 3.3.2 | **다중 모니터 지원 미확인** | 🟡 | 모니터 3개 중 2번 모니터가 제거되면? 창이 어디에? |

#### ⚠️ ThemeManager.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 3.4.1 | **OS 테마 변경 실시간 동기화 미확인** | 🟡 | macOS 시스템 설정에서 dark mode 활성화 → 앱 테마 즉시 변경? 지연? |
| 3.4.2 | **테마 캐시 일관성** | 🟡 | Main과 Renderer의 테마 상태가 동기화되는가? 하나는 light, 다른 하나는 dark? |

#### ⚠️ UpdaterManager.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 3.5.1 | **업데이트 다운로드 중 앱 종료** | 🟡 | 다운로드 50% → 사용자가 앱 종료 → 불완전한 파일 |
| 3.5.2 | **업데이트 자동 재시작 알림 없음** | 🟡 | 사용자가 모르는 사이에 앱이 재시작? 작업 손실? |
| 3.5.3 | **이전 버전으로 롤백 불가** | 🟡 | 새 버전에 버그 발견 → 이전 버전 복원 불가? |

#### ⚠️ NotificationManager.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 3.6.1 | **알림 승인 요청 후 거부됨** | 🟡 | macOS에서 사용자가 "알림 거부" → 그 후 앱이 무한 시도? |
| 3.6.2 | **알림 권한 캐싱** | 🟡 | 권한 상태를 캐싱하는가? 사용자가 시스템 설정에서 권한 변경 → 앱은 여전히 캐시된 상태? |

#### ⚠️ LogManager.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 3.7.1 | **로그 파일 크기 제한 없음** | 🟡 | 앱이 1년 실행 → 로그 파일 1GB+ → 디스크 공간 낭비 |
| 3.7.2 | **로그 파일 순환(rotation) 미구현** | 🟡 | 로그 파일 분할 없음. 오래된 로그 접근 느림 |
| 3.7.3 | **민감한 정보 로깅** | 🟡 | API 키, 사용자 토큰이 로그에 기록되는가? |

#### ⚠️ CacheManager.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 3.8.1 | **캐시 무효화 전략 미확인** | 🟡 | 캐시 만료 시간? TTL? 또는 수동 무효화? |
| 3.8.2 | **캐시 메모리 누수** | 🟡 | 오래된 캐시 항목이 메모리에서 제거되는가? |

---

### 📁 1.4 services/ - 비즈니스 로직

#### ⚠️ PrismaService.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 4.1.1 | **쿼리 성능 프로파일링 부재** | 🟡 | 느린 쿼리 감지? 인덱스 누락 경고? |
| 4.1.2 | **Prisma Client 재연결 미처리** | 🟡 | DB 연결 끊김 → 자동 재연결 로직? |
| 4.1.3 | **트랜잭션 타임아웃** | 🟡 | 긴 트랜잭션이 있으면? DB 리소스 낭비 |

#### ⚠️ OpenAIService.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 4.2.1 | **API 요청 재시도 로직 미확인** | 🟡 | 일시적 네트워크 오류 → 재시도? 몇 번? 백오프 전략? |
| 4.2.2 | **프롬프트 인젝션 방어** | 🟠 | 사용자 입력을 프롬프트에 직접 삽입? 또는 템플릿 사용? |
| 4.2.3 | **스트리밍 응답 타이밍 아웃** | 🟡 | 10초 이상 응답 없으면? 자동 취소? |

#### ⚠️ googleOAuthService.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 4.3.1 | **OAuth 상태값(state) 검증 미확인** | 🔴 | CSRF 공격 방어? state 파라미터 검증? |
| 4.3.2 | **토큰 만료 갱신** | 🟡 | refresh token으로 자동 갱신? 수동? 사용자 알림? |
| 4.3.3 | **토큰 저장소 보안** | 🟠 | Keychain 암호화? 혹은 plain text? |

#### ⚠️ RateLimiterService.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 4.4.1 | **레이트 제한 기준 불명확** | 🟡 | 1분당 최대 몇 요청? 사용자별? 전역? |
| 4.4.2 | **제한 초과 시 사용자 피드백** | 🟡 | 친절한 에러 메시지? "1분 후 다시 시도하세요"? |

---

### 📁 1.5 settings/

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 5.1 | **설정 기본값 하드코딩** | 🟡 | 새로운 설정 추가 시마다 코드 수정? 마이그레이션 메커니즘? |
| 5.2 | **설정 검증 스키마 중앙화** | 🟡 | Zod 스키마가 main과 renderer에 동기화? 불일치 가능성 |

---

### 📁 1.6 types/

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 6.1 | **타입 정의와 Prisma 스키마 동기화** | 🟡 | Prisma 스키마 변경 후 타입 파일 수동 업데이트? 불일치? |

---

## 📁 2. src/renderer/ - React Renderer

### 📁 2.1 src/routes/ - 7개 라우트

#### ⚠️ Home.tsx (대시보드)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 7.1.1 | **대용량 데이터 렌더링** | 🟡 | 프로젝트 1000개를 한 페이지에? 아니면 페이지네이션? |
| 7.1.2 | **IPC 호출 누수** | 🟡 | 컴포넌트 re-render 시마다 `getStats()` 호출? useEffect 의존성 배열 확인? |
| 7.1.3 | **오래된 데이터 표시** | 🟡 | 대시보드가 5분 전 데이터 표시? 실시간 동기화? |

#### ⚠️ ProjectDetail.tsx (에디터)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 7.2.1 | **자동 저장 미구현 또는 미확인** | 🟡 | 사용자가 10분 글 작성 후 앱 크래시 → 데이터 손실? |
| 7.2.2 | **대용량 문서 성능** | 🟠 | 100,000줄의 콘텐츠를 Tiptap에서 렌더? 프리징? |
| 7.2.3 | **변경사항 추적 미확인** | 🟡 | "저장 안 됨" 표시? 사용자가 저장 전 종료 → 경고? |
| 7.2.4 | **Undo/Redo 메모리 사용** | 🟡 | 100번 undo 히스토리 → 메모리 몇 MB? |

#### ⚠️ AI.tsx (AI 어시스턴트)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 7.3.1 | **스트리밍 응답 취소 불가** | 🟡 | 사용자가 "중단" 클릭 → API 요청 계속 실행? 비용 낭비 |
| 7.3.2 | **API 오류 메시지 노출** | 🟡 | 사용자에게 원시 API 에러 표시? "Unknown error" 같은 친절한 메시지? |
| 7.3.3 | **API 키 노출 위험** | 🟡 | 콘솔 로그에 전체 요청/응답 출력? 민감한 정보 노출? |

#### ⚠️ Settings.tsx

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 7.4.1 | **설정 저장 실패 대응** | 🟡 | 저장 클릭 → 네트워크 오류 → 사용자 모르는 사이에 이전 값으로 되돌아감? |
| 7.4.2 | **위험한 설정 변경 경고** | 🟡 | "데이터베이스 리셋" 같은 파괴적 작업 → 확인 대화? |

#### ⚠️ OAuthCallback.tsx

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 7.5.1 | **OAuth 에러 처리 불명확** | 🟡 | 사용자가 "거부" 선택 → 명확한 에러 메시지? |
| 7.5.2 | **Callback URL 검증** | 🟡 | `window.location.href`에서 코드 추출 → CSRF 공격? |
| 7.5.3 | **토큰 저장 위치** | 🟡 | localStorage? sessionStorage? 메모리? 각각의 보안 함의 |

---

### 📁 2.2 components/ - UI 컴포넌트

#### ⚠️ projects/editor/WriterStatsPanel.tsx (현재 열려있는 파일)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 8.1.1 | **통계 데이터 실시간 동기화** | 🟡 | 글 작성 중 통계가 업데이트되는가? 지연? |
| 8.1.2 | **대용량 차트 렌더링** | 🟡 | 1년치 일별 통계 → Recharts 성능? |
| 8.1.3 | **IPC 호출 과다** | 🟡 | 매 글자 입력할 때마다 통계 조회? debounce? |

#### ⚠️ common/ (로더, 에러, 모달 등)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 8.2.1 | **에러 바운더리 미구현** | 🟡 | 컴포넌트 크래시 → 전체 앱 다운? 부분 폴백? |
| 8.2.2 | **로더 상태 무한 루프** | 🟡 | IPC 요청이 응답 안 함 → 영원히 로딩 상태? |

#### ⚠️ layout/ (레이아웃)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 8.3.1 | **반응형 디자인 미지원** | 🟡 | 창 크기 변경 시 레이아웃 깨짐? |

---

### 📁 2.3 hooks/ - React 훅

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 9.1 | **IPC 호출 캐싱 미지원** | 🟡 | `useProjects()` 호출 → 매번 fresh 데이터? 너무 자주 호출하면? |
| 9.2 | **에러 핸들링 일관성** | 🟡 | 모든 IPC 호출에 try-catch? 어떤 훅은 있고 어떤 훅은 없나? |
| 9.3 | **cleanup 미등록** | 🟡 | 컴포넌트 언마운트 시 pending IPC 요청 취소? |

---

### 📁 2.4 stores/ - Zustand

#### ⚠️ useStructureStore.ts (유일한 스토어)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 10.1 | **DB와 스토어 동기화 불명확** | 🟡 | 사용자가 Renderer에서 구조 수정 → DB에 저장? 스토어에 저장? 둘 다? |
| 10.2 | **스토어 크기 제한 없음** | 🟡 | 프로젝트 구조가 매우 크면(계층 1000개) → 메모리? |
| 10.3 | **persistence 설정 미확인** | 🟡 | localStorage에 전체 상태 저장? 암호화? |

---

### 📁 2.5 contexts/

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 11.1 | **Provider Hell** | 🟡 | 중첩된 Context provider로 인한 성능 저하? |
| 11.2 | **컨텍스트 값 변경 시 불필요한 re-render** | 🟡 | Context 최적화 (값 메모이제이션)? |

---

## 📁 3. src/shared/ - 공유 계층

### 📁 3.1 types/

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 12.1 | **Prisma 타입과 수동 타입 불일치** | 🟡 | Prisma 스키마 변경 → 공유 타입 수동 업데이트 → 휴먼 에러 |
| 12.2 | **Optional vs Nullable 혼동** | 🟡 | DTO 타입이 `string | undefined` vs `string | null`? 일관성 없음 |

### 📁 3.2 validation/

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 13.1 | **런타임 검증만 수행** | 🟡 | 컴파일 타임에 타입 검증? 또는 런타임만? |
| 13.2 | **검증 실패 메시지 불명확** | 🟡 | "Invalid input" vs "title must be string with max 255 chars"? |

### 📁 3.3 logger/

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 14.1 | **로거 성능** | 🟡 | 프로덕션 환경에서도 DEBUG 로그 필터링? |
| 14.2 | **로거 메모리 누수** | 🟡 | 로그 메모리에 계속 누적? 주기적 정리? |

### 📁 3.4 ai/ (AI 설정)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 15.1 | **프롬프트 버전 관리** | 🟡 | 프롬프트 변경 시 버전? 이전 결과와 비교 불가? |
| 15.2 | **모델 버전 고정** | 🟡 | OpenAI "gpt-4" → 최신? 특정 버전? 불명확 |

---

## 📁 4. src/preload/ - Preload 스크립트

### ⚠️ index.ts (714줄)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 16.1 | **IPC 채널 화이트리스트 역도** | 🟡 | 만약 Renderer가 없는 채널로 invoke 시도? 타임아웃 + 에러 |
| 16.2 | **응답 타입 검증 미확인** | 🟡 | Main이 잘못된 형태로 응답 → Renderer 크래시? |
| 16.3 | **keyboard API 더미 구현** | 🟡 | keyboard.* 메서드가 모두 `false` 반환 → 코드에서 if 체크 있나? |
| 16.4 | **API 버전 관리** | 🟡 | Preload API 변경 → 레거시 Renderer 지원? |
| 16.5 | **contextBridge 오버헤드** | 🟡 | contextBridge 메시지 패싱 성능? 특히 대용량 데이터 |

---

## 📁 5. prisma/ - 데이터베이스

### ⚠️ schema.prisma (531줄)

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 17.1 | **마이그레이션 충돌** | 🟡 | 여러 개발자가 동시에 스키마 변경 → 마이그레이션 순서 충돌 |
| 17.2 | **레거시 모델 (TypingSession 등)** | 🟡 | 키보드 모니터링 비활성화되었는데 스키마에 남아있음 → 혼동 야기 |
| 17.3 | **인덱스 최적화 미완료** | 🟡 | 문서에서 "9개 추가 인덱스 권장" → 아직 미적용 |
| 17.4 | **외래키 제약 부재** | 🟡 | 일부 관계가 명시적 제약 없음? 고아 레코드 가능? |
| 17.5 | **JSON 필드의 스키마 미정의** | 🟡 | `tags`, `criteria`, `metadata` JSON 필드 → 구조 문서화? 타입? |
| 17.6 | **데이터 타입 일관성** | 🟡 | `Project.author` 문자열, `Episode.act` 문자열 → 열거형이 나은가? |

### ⚠️ migrations/

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 17.7 | **이전 마이그레이션 정리 미확인** | 🟡 | 마이그레이션 폴더에 100+ 파일? 레거시 정리? |
| 17.8 | **마이그레이션 테스트** | 🟡 | 프로덕션에 적용 전 테스트? 어떤 시나리오? |
| 17.9 | **롤백 전략** | 🟡 | 마이그레이션 실패 → 이전 버전으로 자동 롤백? 수동? |

---

## 📁 6. Root 설정 파일

### ⚠️ tsconfig.json

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 18.1 | **strict: true는 좋지만 any 제외 확인** | 🟡 | `noImplicitAny: true`? `noImplicitThis: true`? |
| 18.2 | **Path 별칭 충돌 가능성** | 🟡 | `@/*`, `@shared/*`, `@main/*` 등 - 충돌 경우 없나? |

### ⚠️ electron.vite.config.ts

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 18.3 | **환경변수 로딩 순서** | 🟡 | `.env` vs `.env.local` vs `.env.production` 순서? 우선순위? |
| 18.4 | **Main/Renderer 환경 분리** | 🟡 | Main 환경변수가 Renderer에 노출되는가? 보안 검토? |

### ⚠️ package.json

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 18.5 | **의존성 버전 핀닝** | 🟡 | 패키지 버전이 고정되었는가? `^1.2.3` vs `1.2.3`? |
| 18.6 | **보안 취약점 스캔** | 🟡 | npm audit? Snyk? 정기적인 보안 검사? |
| 18.7 | **Electron 버전 업그레이드 계획** | 🟡 | Electron 38 LTS → 40, 42는 언제? |

### ⚠️ .env.* 파일

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 18.8 | **민감한 환경변수 .gitignore** | 🟡 | `.env.local` git 무시? 또는 `.env.example`로 템플릿 제공? |
| 18.9 | **프로덕션 환경변수 관리** | 🟡 | CI/CD에서 환경변수 주입? GitHub Secrets? |

### ⚠️ eslint, prettier 설정

| # | 문제 | 심각도 | 세부 설명 |
|---|------|--------|---------|
| 18.10 | **Lint 규칙 일관성** | 🟡 | 모든 IDE에서 같은 규칙 적용? 혹은 불일치? |
| 18.11 | **Pre-commit 훅** | 🟡 | lint check 자동 실행? 또는 수동? |

---

## 📁 7. 프로젝트 전체 아키텍처 이슈

### 🔴 Critical Level Issues

| # | 문제 | 영향 범위 | 설명 |
|---|------|---------|------|
| 19.1 | **IPC Race Condition** | Main ↔ Renderer | Phase 1 초기화 중 Renderer의 IPC 호출 → 핸들러 미등록 에러 |
| 19.2 | **동시성 제어 부재** | Main Process | SQLite 동시 쓰기 제한 + IPC 병렬 요청 → SQLITE_BUSY |
| 19.3 | **트랜잭션 미사용** | Database | 부분 저장 가능성 → 데이터 무결성 훼손 |
| 19.4 | **API 키 보안** | All Layers | 환경변수에서 렌더러까지의 키 전달 경로 검증 필요 |

### 🟠 High Priority Issues

| # | 문제 | 영향 범위 | 설명 |
|---|------|---------|------|
| 20.1 | **N+1 쿼리** | Database | 대용량 데이터셋에서 성능 저하 |
| 20.2 | **메모리 누수** | Main Process | 싱글톤 매니저의 영구 할당 |
| 20.3 | **에러 복구 전략 미흡** | All | 부분 초기화 후 일관성 보장 불명확 |
| 20.4 | **자동 저장 미확인** | Renderer | 앱 크래시 시 작업 손실 위험 |

### 🟡 Medium Priority Issues

| # | 문제 | 영향 범위 | 설명 |
|---|------|---------|------|
| 21.1 | **API 요청 타임아웃** | AI Services | 무한 대기 가능성 |
| 21.2 | **스트리밍 응답 버퍼** | IPC | 대용량 응답 시 채널 포화 |
| 21.3 | **권한 캐싱** | System Integration | 사용자가 시스템 설정 변경 → 앱은 미반영 |
| 21.4 | **로그 파일 크기** | Disk Space | 무제한 증가 → 디스크 낭비 |

---

## 🎯 즉시 조치 필요 항목 (Top 10)

```
1. ✅ IPC Race Condition 검토 (bootstrap 순서 확정)
2. ✅ 동시성 제어 전략 수립 (Mutex/Lock 도입)
3. ✅ N+1 쿼리 성능 테스트 (대용량 데이터)
4. ✅ API 키 전달 경로 감시 (보안 리뷰)
5. ✅ 자동 저장 기능 확인 (데이터 손실 방지)
6. ✅ 에러 복구 메커니즘 수립 (부분 초기화 시나리오)
7. ✅ 마이그레이션 테스트 전략 (DB 안정성)
8. ✅ 로그 파일 로테이션 (디스크 관리)
9. ✅ API 요청 타임아웃 설정 (무한 대기 방지)
10. ✅ 메모리 누수 프로파일링 (매니저 생명주기)
```

---

## 📊 요약 통계

| 카테고리 | 🔴 Critical | 🟠 High | 🟡 Medium | 🟢 Low | 합계 |
|---------|-----------|--------|---------|--------|------|
| main/core | 4 | 3 | 8 | 2 | 17 |
| main/handlers | 6 | 4 | 12 | 3 | 25 |
| main/managers | 1 | 4 | 18 | 5 | 28 |
| main/services | 2 | 3 | 8 | 2 | 15 |
| renderer/routes | 1 | 2 | 10 | 3 | 16 |
| renderer/components | 0 | 2 | 8 | 2 | 12 |
| renderer/hooks | 0 | 1 | 4 | 1 | 6 |
| shared | 0 | 1 | 6 | 2 | 9 |
| preload | 1 | 2 | 3 | 1 | 7 |
| prisma | 0 | 1 | 9 | 2 | 12 |
| config | 0 | 1 | 5 | 1 | 7 |
| **전체** | **15** | **24** | **91** | **24** | **154** |

---

## 🔍 추천 다음 단계

1. **우선순위 1 (Critical)**: 15개 항목 모두 검토 및 테스트
2. **우선순위 2 (High)**: 24개 High 이슈 중 상위 10개 해결
3. **우선순위 3 (Medium)**: 91개 항목 중 비즈니스 영향도 높은 순서로 처리
4. **지속적 모니터링**: 프로덕션 배포 후 에러 로그 추적

